#!/usr/bin/env bash
###############################################################################
# Script Name  : sftpin
# Description  : Connects to host computer via sftp
# Dependencies : sftp
# arguments    : Last octet of target host's IP address
# Author       : Richard Romig
# Email        : rick.romig@gmail.com
# Comments     : Based on script by Joe Collins, EzeeLinux.com
#              : localnet and valid_ip are declared in functionlib
# TODO (rick)  :
# License      : GNU General Public License, version 2.0
###############################################################################

## Shellcheck Directives ##
# shellcheck source=/home/rick/bin/functionlib
# shellcheck disable=SC1091

## Load function library ##

if [[ -x "$HOME/bin/functionlib" ]]; then
  source "$HOME/bin/functionlib"
else
  printf "\e[91mERROR:\e[0m functionlib not found!\n" >&2
  exit 1
fi

## Variables ##

_script=$(basename "$0"); readonly _script
readonly _version="2.1.0"
readonly _updated="08 Sep 2023"

## Functions ##

usage() {
  local errcode="${1:-2}"
  cat << END_HELP
${orange}Usage:${normal} $_script <last octet>
Example: $_script 15
Argument is the last octet of the remote server's IP address.
END_HELP
  exit "$errcode"
}

## Execution ##

printf "%s v%s (%s)\n" "$_script" "$_version" "$_updated"
printf "Log in to a remote server using Secure File Transfer Protocol (SFTP).\n"

if [[ $# -eq 0 ]]; then
  printf "%s No argument passed.\nEnter last octet of remote server's IP address.\n" "$red_error" >&2
  usage 2
elif [[ "$1" == "-h" || "$1" == "--help" ]]; then
  printf "%s%s help%s\n" "$green" "$_script" "$normal"
  usage 0
else
  valid_ip "$1" && hostip="$1"
  /usr/bin/sftp "$localnet.$hostip"
fi

exit
