#!/usr/bin/env bash
##########################################################################
# Script Name  : clone-repo
# Description  : Clone a git repository from local Gitea server
# Dependencies : git
# Arguments    : None
# Author       : Copyright (C) 2022 Richard B. Romig, created: 19 Oct 2022
# Email        : rick.romig@gmail.com | rick.romig@mymetronet.net
# Comments     :
# TODO (Rick)  :
# License      : GNU General Public License, version 2.0
##########################################################################

## Shellcheck Directives ##
# shellcheck source=/home/rick/bin/functionlib
# shellcheck disable=SC1091,SC2034

## Source function library ##

if [[ -x "$HOME/bin/functionlib" ]]; then
  source "$HOME/bin/functionlib"
else
  printf "\e[91mERROR:\e[0m functionlib not found!\n" >&2
  exit 1
fi

## Global Variables ##

readonly _script=$(basename "$0")
readonly _version="0.2.0"
readonly _updated="20 Oct 2022"
readonly red_error="${lightred}ERROR:${normal}"
readonly repos=( scripts configs i3debian openboxdebian fnloc fnloc-win )

## Functions ##

clone_repo() {
  local git_repo="$1"
  local gitea_svr="http://192.168.0.16:3000/Nullifidian"
  local dl_dir="$HOME/Downloads"
  git clone "$gitea_svr/$git_repo.git" "$dl_dir/$git_repo"
}

## Execution ##

check_package git

# clear
printf "\U1F427 %s v%s (%s)\n" "$_script" "$_version" "$_updated"
printf "Clone a repository from the local Gitea server.\n\n"
printf "Available repositories:\n"
COLUMNS=40
options=( "Bash scripts" "Configuration files" "i3-gaps Debian " "Openbox Debinan" "FnLoC" "FnLoC-Win" "Exit" )
PS3="Choose a repository to clone: "
select opt in "${options[@]}"; do
  case "$REPLY" in
    1 )
      clone_repo "${repos[0]}"
      break ;;
    2 )
      clone_repo "${repos[1]}"
      break ;;
    3 )
      clone_repo "${repos[2]}"
      break ;;
    4 )
      clone_repo "${repos[3]}"
      break ;;
    5 )
      clone_repo "${repos[4]}"
      break ;;
    6 )
      clone_repo "${repos[5]}"
      break ;;
    7 )
      leave "Exiting. No repositories cloned."
      ;;
    * )
      printf "%s Invalid choice. Choose 1-7.\n" "$red_error" >&2
      ;;
  esac
done
exit
