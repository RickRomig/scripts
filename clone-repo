#!/usr/bin/env bash
##########################################################################
# Script Name  : clone-repo
# Description  : Clone a git repository from local Gitea server
# Dependencies : git
# Arguments    : None
# Author       : Copyright (C) 2022, Richard B. Romig, created: 19 Oct 2022
# Email        : rick.romig@gmail.com | rick.romig@mymetronet.net
# Comments     :
# TODO (Rick)  :
# License      : GNU General Public License, version 2.0
##########################################################################

## Shellcheck Directives ##
# shellcheck disable=SC2034

## Global Variables ##

_script=$(basename "$0"); readonly _script
readonly _version="0.2.1"
readonly _updated="10 Nov 2023"
readonly repos=( scripts configs i3debian deb12wm-scripts deb12wm-dotfiles gitea-server openboxdebian fnloc fnloc-win homepage )

## Functions ##

exist_git() {
  if command -v git > /dev/null 2>&1; then
    printf "git - [OK]\n"
  else
    sudo apt-get install git -yyq
  fi
}

clone_repo() {
  local git_repo="$1"
  local gitea_svr="http://192.168.0.16:3000/Nullifidian"
  local dl_dir="$HOME/Downloads"
  git clone "$gitea_svr/$git_repo.git" "$dl_dir/$git_repo"
}

## Execution ##

exist_git

printf "%s v%s (%s)\n" "$_script" "$_version" "$_updated"
printf "Clone a repository from the local Gitea server.\n\n"
printf "Available repositories:\n"
COLUMNS=40
options=( "Bash scripts" "Configuration files" "Debian i3 WM" "Debian 12 WM scripts" "Debian 12 WM dotfiles" "Gitea Server" "Openbox Debian" "FnLoC" "FnLoC-Win" "Homepage" "Exit" )
PS3="Choose a repository to clone: "
select opt in "${options[@]}"; do
  case "$REPLY" in
    1 )
      clone_repo "${repos[0]}"
      break
    ;;
    2 )
      clone_repo "${repos[1]}"
      break
    ;;
    3 )
      clone_repo "${repos[2]}"
      break
    ;;
    4 )
      clone_repo "${repos[3]}"
      break
    ;;
    5 )
      clone_repo "${repos[4]}"
      break
    ;;
    6 )
      clone_repo "${repos[5]}"
      break
    ;;
    7 )
      clone_repo "${repos[6]}"
      break
    ;;
    8 )
      clone_repo "${repos[7]}"
      break
    ;;
    9 )
      clone_repo "${repos[8]}"
      break
    ;;
    10 )
      clone_repo "${repos[9]}"
      break
    ;;
    11 )
      printf "Exiting. No repositories cloned.\n"
      break
    ;;
    * )
      printf "\e[91mERROR:\e[0m Invalid choice. Choose 1-9.\n" >&2
  esac
done
exit
